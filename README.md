# PayToFly

一个功能完整的 Minecraft 飞行权限插件，支持飞行时间购买、华丽特效系统和多等级速度控制。

## 功能特点

- 💰 支持使用游戏币购买飞行权限
- ⏱️ 灵活的时间计算系统
- 📊 直观的 GUI 商店界面
- 🌍 多语言支持
- 💾 数据持久化存储
- ⚡ 性能优化，低资源占用
- 🔔 到期提醒系统
- 📝 PlaceholderAPI 支持
- 🌐 世界权限控制
- 🔑 权限系统
- 🎨 飞行特效系统（7种特效等级）
- 🚀 飞行速度控制（7个速度等级）
- 🎵 音效支持
- 🌊 平滑速度过渡
- 💸 特效和速度购买系统
- 🔒 权限和购买双重验证

## 指令

- `/fly` - 打开飞行商店
- `/fly time` - 查看剩余飞行时间
- `/fly help` - 显示帮助信息
- `/fly reload` - 重载插件配置 (需要权限)
- `/fly [时间]` - 购买飞行时间
- `/fly bypass [用户名]` - 绕过创造模式飞行限制
- `/fly disable [用户名]` - 关闭用户的飞行权限
- `/fly give <玩家名> <时间>` - 管理员直接给予玩家飞行权限
- `/fly test` - 测试Papi输出内容

### 飞行特效命令
- `/fly effect` - 查看当前特效信息
- `/fly effect list` - 显示可用特效列表
- `/fly effect set <特效名>` - 设置飞行特效
- `/fly effect buy <特效名>` - 购买飞行特效
- `/fly effect off` - 禁用飞行特效

### 飞行速度命令
- `/fly speed` - 查看当前速度信息
- `/fly speed list` - 显示可用速度列表
- `/fly speed set <速度名>` - 设置飞行速度
- `/fly speed buy <速度名>` - 购买飞行速度
- `/fly speed up/down` - 升级/降级速度
- `/fly speed reset` - 重置到默认速度

## 权限

- `paytofly.use` - 允许使用基础功能
- `paytofly.infinite` - 无限飞行权限
- `paytofly.admin` - 管理员权限
- `paytofly.creative.bypass` - 绕过创造模式飞行限制的权限

### 飞行特效权限
- `paytofly.effects.*` - 所有特效权限
- `paytofly.effects.<effect_name>` - 特定特效权限

### 飞行速度权限
- `paytofly.speed.*` - 所有速度权限
- `paytofly.speed.<speed_name>` - 特定速度权限
- `paytofly.speed.level.<level>` - 基于等级的权限
- `paytofly.speed.max.<level>` - 最大允许等级

## PlaceholderAPI 变量

- `%paytofly_remaining%` - 显示剩余飞行时间
- `%paytofly_status%` - 显示飞行状态 (已开启/已关闭)
- `%paytofly_expiretime%` - 显示到期时间
- `%paytofly_mode%` - 显示当前计时模式 (现实时间/游戏时间)

## 快速开始

### 🚀 基础安装
1. 下载最新版本的插件
2. 将插件放入服务器的 `plugins` 文件夹
3. 安装 Vault 和经济插件（如 EssentialsX）
4. 重启服务器
5. 编辑 `config.yml` 配置文件

### ⚡ 5分钟配置
```yaml
# 1. 设置语言（可选）
language: zh_CN  # 或 en_US

# 2. 配置经济系统
fly-cost:
  minute: 10.0   # 每分钟10金币
  hour: 100.0    # 每小时100金币

# 3. 启用特效和速度购买
flight-effects:
  purchase:
    enabled: true

flight-speed:
  purchase:
    enabled: true
```

### 🎮 立即体验
1. 玩家输入 `/fly` 购买飞行时间
2. 输入 `/fly effect list` 查看特效
3. 输入 `/fly effect buy rainbow` 购买彩虹特效
4. 输入 `/fly speed buy fast` 购买快速飞行
5. 开始飞行享受华丽特效！

## 详细安装

1. 下载最新版本的插件
2. 将插件放入服务器的 `plugins` 文件夹
3. 重启服务器或重载插件
4. 编辑 `config.yml` 配置文件

## 依赖

- Vault (经济系统支持)
- PlaceholderAPI (可选，变量支持)

## 支持的版本
- 需要Java17及以上版本
- Minecraft 1.21.x（已测试）
- Minecraft 1.20.x（已测试）
- Minecraft 1.19.x（未测试）
- Minecraft 1.18.x（未测试）
- Minecraft 1.17.x（未测试）
- Minecraft 1.16.x（未测试）

## 飞行特效系统

支持7种特效等级，从简单到华丽：
- **无特效** - 不显示任何特效
- **基础特效** - 简单的白色粒子
- **彩虹特效** - 彩色尾迹效果
- **星星特效** - 闪烁的星星粒子
- **火焰特效** - 火花和烟雾效果
- **魔法特效** - 魔法粒子和符文
- **龙息特效** - 高级龙息效果

## 飞行速度控制

支持7个速度等级，满足不同需求：
- **缓慢** (0.05) - 适合精细操作
- **普通** (0.1) - 默认飞行速度
- **快速** (0.2) - 提升移动效率
- **极速** (0.3) - 高速飞行
- **超速** (0.5) - 极快移动
- **光速** (0.8) - 接近光速
- **曲速** (1.0) - 最快速度

## 购买系统

### 💸 特效购买价格
- **基础特效** - 100金币
- **彩虹特效** - 500金币  
- **星星特效** - 800金币
- **火焰特效** - 1200金币
- **魔法特效** - 2000金币
- **龙息特效** - 5000金币

### 🚀 速度购买价格  
- **缓慢速度** - 50金币
- **普通速度** - 免费
- **快速速度** - 200金币
- **极速** - 600金币
- **超速** - 1500金币
- **光速** - 3000金币
- **曲速** - 8000金币

### 🔒 权限与购买
玩家可以通过以下方式获得特效和速度：

1. **权限方式**（管理员设置）
   - 拥有对应权限可直接使用
   - 管理员可设置 `paytofly.effects.*` 获得所有特效
   - 管理员可设置 `paytofly.speed.*` 获得所有速度

2. **购买方式**（玩家自购）
   - 使用游戏币购买，永久拥有
   - 购买后无需权限即可使用
   - 支持所有经济系统（Vault、MHDF-Tools）

3. **混合使用**
   - 有权限的直接使用，无权限的可购买
   - 权限优先，购买作为补充
   - 购买记录永久保存

## 配置说明

### 价格配置
在 `config.yml` 中可以自定义所有价格：

```yaml
# 飞行特效价格设置
flight-effects:
  purchase:
    enabled: true
    prices:
      basic: 100.0
      rainbow: 500.0
      star: 800.0
      fire: 1200.0
      magic: 2000.0
      dragon: 5000.0

# 飞行速度价格设置
flight-speed:
  purchase:
    enabled: true
    prices:
      slow: 50.0
      normal: 0.0        # 免费
      fast: 200.0
      very_fast: 600.0
      super_fast: 1500.0
      light_speed: 3000.0
      warp_speed: 8000.0
```

### 存储系统
支持三种存储方式，购买记录永久保存：
- **JSON存储** - 轻量级文件存储
- **SQLite存储** - 本地数据库存储  
- **MySQL存储** - 远程数据库存储

## 使用指南

### 基础使用
1. 玩家输入 `/fly` 打开飞行商店购买飞行时间
2. 使用 `/fly effect list` 查看可用特效
3. 使用 `/fly speed list` 查看可用速度
4. 通过购买或权限获得特效和速度

### 购买流程
1. 检查余额：`/fly effect buy rainbow`
2. 自动扣款并记录购买
3. 立即可用，永久拥有
4. 设置使用：`/fly effect set rainbow`

### 管理员操作
- 给予权限：直接设置对应权限节点
- 调整价格：修改 `config.yml` 配置文件
- 查看统计：使用 `/fly stats` 命令

## 特色功能

### 🎨 视觉体验
- **7种特效等级**：从简单粒子到华丽龙息
- **动态音效**：特效启动和停止音效
- **平滑过渡**：无缝的速度变化体验
- **性能优化**：智能调度，静止时减少特效

### 💰 经济系统
- **双重获取方式**：权限或购买均可获得
- **灵活定价**：管理员可自定义所有价格
- **防重复购买**：智能检查已拥有状态
- **经济兼容**：支持Vault和MHDF-Tools

### 💾 数据管理
- **多存储支持**：JSON/SQLite/MySQL三种选择
- **向后兼容**：自动升级旧数据格式
- **数据持久化**：购买记录永久保存
- **性能优化**：批量写入，连接池管理

### 🔧 管理功能
- **权限细分**：精细的权限控制系统
- **统计监控**：系统性能和使用统计
- **多语言**：中英文双语支持
- **热重载**：配置修改即时生效

## 常见问题

### Q: 如何给玩家永久的飞行特效？
A: 管理员可以设置权限 `paytofly.effects.*` 或让玩家购买对应特效。

### Q: 玩家购买后能否退款？
A: 目前不支持退款功能，购买前请确认。管理员可手动删除购买记录。

### Q: 如何调整特效和速度的价格？
A: 修改 `config.yml` 中的 `flight-effects.purchase.prices` 和 `flight-speed.purchase.prices` 配置。

### Q: 支持哪些经济插件？
A: 支持所有兼容Vault的经济插件，以及MHDF-Tools内置经济。

### Q: 数据会丢失吗？
A: 不会，购买记录保存在持久化存储中，支持备份和恢复。

## 未来规划

- [x] 飞行特效系统 ✅
- [x] 飞行速度控制 ✅
- [x] 特效和速度购买系统 ✅
- [ ] GUI商店界面优化
- [ ] API接口开放
- [ ] 更多特效类型
- [ ] 速度预设方案
- [ ] 统计和排行榜
- [ ] 更多语言支持

## 问题反馈

如果您在使用过程中遇到任何问题，请通过以下方式反馈：
1. 在 GitHub Issues 中提交问题

## 开源协议

本项目采用 MIT 协议开源。

## 支持作者

如果您觉得这个插件对您有帮助，欢迎：
1. 给项目一个 Star ⭐
2. 向他人推荐本插件
3. 参与项目开发 
